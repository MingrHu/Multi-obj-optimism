训练晶粒尺寸标准差模型...

=== 第 1/20 次训练 ===
2025-09-24 10:44:20.510236: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.7674
NMAE: 2.7325
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 29.5821
实际值: 31.7000, 预测值: 30.0144
实际值: 22.2100, 预测值: 22.6377
实际值: 26.1800, 预测值: 27.4933
实际值: 26.5300, 预测值: 23.7302

=== 第 2/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 53ms/step
R²分数: -0.1513
NMAE: 2.5058
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.2285
实际值: 31.7000, 预测值: 24.3632
实际值: 22.2100, 预测值: 26.5328
实际值: 26.1800, 预测值: 26.8939
实际值: 26.5300, 预测值: 25.0265

=== 第 3/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.1469
NMAE: 2.1024
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.5978
实际值: 31.7000, 预测值: 27.2422
实际值: 22.2100, 预测值: 26.6876
实际值: 26.1800, 预测值: 26.3109
实际值: 26.5300, 预测值: 24.2092

=== 第 4/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.0347
NMAE: 2.3502
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.9134
实际值: 31.7000, 预测值: 26.4876
实际值: 22.2100, 预测值: 26.7990
实际值: 26.1800, 预测值: 27.2841
实际值: 26.5300, 预测值: 27.1048

=== 第 5/20 次训练 ===
WARNING:tensorflow:5 out of the last 5 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7f4d641e27a0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step
R²分数: 0.5920
NMAE: 1.8844
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.1111
实际值: 31.7000, 预测值: 29.5428
实际值: 22.2100, 预测值: 24.0886
实际值: 26.1800, 预测值: 28.1356
实际值: 26.5300, 预测值: 26.0876

=== 第 6/20 次训练 ===
WARNING:tensorflow:6 out of the last 6 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7f4d9c2f5630> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.0758
NMAE: 2.2561
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.0650
实际值: 31.7000, 预测值: 26.8357
实际值: 22.2100, 预测值: 26.9001
实际值: 26.1800, 预测值: 26.0336
实际值: 26.5300, 预测值: 26.4424

=== 第 7/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 127ms/step
R²分数: 0.8808
NMAE: 3.1835
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 32.9063
实际值: 31.7000, 预测值: 30.2831
实际值: 22.2100, 预测值: 23.2666
实际值: 26.1800, 预测值: 26.0605
实际值: 26.5300, 预测值: 23.9706

=== 第 8/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.6088
NMAE: 2.3267
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.4411
实际值: 31.7000, 预测值: 28.5708
实际值: 22.2100, 预测值: 23.2644
实际值: 26.1800, 预测值: 26.0465
实际值: 26.5300, 预测值: 21.8874

=== 第 9/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 64ms/step
R²分数: 0.6343
NMAE: 2.0377
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.8867
实际值: 31.7000, 预测值: 30.4726
实际值: 22.2100, 预测值: 24.7831
实际值: 26.1800, 预测值: 28.0289
实际值: 26.5300, 预测值: 25.7192

=== 第 10/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 64ms/step
R²分数: 0.6980
NMAE: 2.2637
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.7491
实际值: 31.7000, 预测值: 29.6556
实际值: 22.2100, 预测值: 22.6411
实际值: 26.1800, 预测值: 27.9346
实际值: 26.5300, 预测值: 23.7546

=== 第 11/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.4849
NMAE: 2.2896
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.4061
实际值: 31.7000, 预测值: 28.8246
实际值: 22.2100, 预测值: 22.0309
实际值: 26.1800, 预测值: 27.5867
实际值: 26.5300, 预测值: 22.1029

=== 第 12/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.5916
NMAE: 2.3667
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.6779
实际值: 31.7000, 预测值: 30.1745
实际值: 22.2100, 预测值: 22.5733
实际值: 26.1800, 预测值: 26.2941
实际值: 26.5300, 预测值: 22.7952

=== 第 13/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: -0.1054
NMAE: 2.3141
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.3836
实际值: 31.7000, 预测值: 24.9071
实际值: 22.2100, 预测值: 26.4326
实际值: 26.1800, 预测值: 25.2217
实际值: 26.5300, 预测值: 24.7620

=== 第 14/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.0326
NMAE: 2.2109
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.4490
实际值: 31.7000, 预测值: 29.0369
实际值: 22.2100, 预测值: 26.9908
实际值: 26.1800, 预测值: 27.0502
实际值: 26.5300, 预测值: 26.6594

=== 第 15/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.5774
NMAE: 2.2625
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.9570
实际值: 31.7000, 预测值: 31.9455
实际值: 22.2100, 预测值: 26.0781
实际值: 26.1800, 预测值: 26.7862
实际值: 26.5300, 预测值: 24.2816

=== 第 16/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step
R²分数: 0.1383
NMAE: 2.3391
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.0475
实际值: 31.7000, 预测值: 26.7765
实际值: 22.2100, 预测值: 25.9803
实际值: 26.1800, 预测值: 26.4184
实际值: 26.5300, 预测值: 25.4745

=== 第 17/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 69ms/step
R²分数: 0.9078
NMAE: 3.1533
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 31.6622
实际值: 31.7000, 预测值: 32.2205
实际值: 22.2100, 预测值: 21.9846
实际值: 26.1800, 预测值: 26.7364
实际值: 26.5300, 预测值: 24.3801

=== 第 18/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.0534
NMAE: 2.1643
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.9945
实际值: 31.7000, 预测值: 25.1165
实际值: 22.2100, 预测值: 26.9568
实际值: 26.1800, 预测值: 25.8318
实际值: 26.5300, 预测值: 25.4111

=== 第 19/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.7554
NMAE: 2.9160
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.8978
实际值: 31.7000, 预测值: 29.8532
实际值: 22.2100, 预测值: 23.2753
实际值: 26.1800, 预测值: 29.0820
实际值: 26.5300, 预测值: 22.3705

=== 第 20/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 68ms/step
R²分数: 0.0671
NMAE: 2.2236
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.7070
实际值: 31.7000, 预测值: 24.9449
实际值: 22.2100, 预测值: 26.8452
实际值: 26.1800, 预测值: 26.5378
实际值: 26.5300, 预测值: 26.5168

=== 最佳模型已保存 ===
最高 R²分数: 0.9078

最佳模型预测结果(前5行):
实际值: 30.7500, 预测值: 31.6622
实际值: 31.7000, 预测值: 32.2205
实际值: 22.2100, 预测值: 21.9846
实际值: 26.1800, 预测值: 26.7364
实际值: 26.5300, 预测值: 24.3801

训练模具载荷模型...

=== 第 1/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.8138
NMAE: 2.1895
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 261872.4688
实际值: 225720.8200, 预测值: 236542.7812
实际值: 337980.3600, 预测值: 327592.0625
实际值: 315083.0500, 预测值: 303211.8750
实际值: 378091.2700, 预测值: 370283.0000

=== 第 2/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.8791
NMAE: 2.5079
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 278775.3438
实际值: 225720.8200, 预测值: 237755.2188
实际值: 337980.3600, 预测值: 310253.8125
实际值: 315083.0500, 预测值: 307467.4375
实际值: 378091.2700, 预测值: 386400.2188

=== 第 3/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 68ms/step
R²分数: 0.8228
NMAE: 2.3299
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 254036.3125
实际值: 225720.8200, 预测值: 219073.1562
实际值: 337980.3600, 预测值: 320675.0938
实际值: 315083.0500, 预测值: 304879.8125
实际值: 378091.2700, 预测值: 379393.9062

=== 第 4/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 70ms/step
R²分数: 0.7965
NMAE: 1.9558
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 268784.6250
实际值: 225720.8200, 预测值: 238362.3750
实际值: 337980.3600, 预测值: 316631.8750
实际值: 315083.0500, 预测值: 292046.5000
实际值: 378091.2700, 预测值: 374162.0000

=== 第 5/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.8279
NMAE: 1.8991
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 267963.4062
实际值: 225720.8200, 预测值: 233929.7031
实际值: 337980.3600, 预测值: 314367.9062
实际值: 315083.0500, 预测值: 296032.5625
实际值: 378091.2700, 预测值: 378023.9688

=== 第 6/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.8306
NMAE: 2.4987
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 258002.2188
实际值: 225720.8200, 预测值: 226806.2344
实际值: 337980.3600, 预测值: 324914.6250
实际值: 315083.0500, 预测值: 320162.5000
实际值: 378091.2700, 预测值: 387431.1562

=== 第 7/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.8161
NMAE: 2.0302
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 260653.7188
实际值: 225720.8200, 预测值: 226656.0156
实际值: 337980.3600, 预测值: 318996.0938
实际值: 315083.0500, 预测值: 295917.3750
实际值: 378091.2700, 预测值: 386472.7500

=== 第 8/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step
R²分数: 0.8669
NMAE: 2.0171
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 262863.7812
实际值: 225720.8200, 预测值: 243363.7969
实际值: 337980.3600, 预测值: 317779.7500
实际值: 315083.0500, 预测值: 291453.3125
实际值: 378091.2700, 预测值: 389125.6250

=== 第 9/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.8194
NMAE: 2.2584
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 266409.4688
实际值: 225720.8200, 预测值: 227988.3750
实际值: 337980.3600, 预测值: 318821.1250
实际值: 315083.0500, 预测值: 292015.0000
实际值: 378091.2700, 预测值: 380420.1562

=== 第 10/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.8326
NMAE: 2.5667
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 268522.8438
实际值: 225720.8200, 预测值: 250821.4844
实际值: 337980.3600, 预测值: 321365.4062
实际值: 315083.0500, 预测值: 305668.0625
实际值: 378091.2700, 预测值: 384218.7188

=== 第 11/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.8505
NMAE: 2.2339
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 268752.8125
实际值: 225720.8200, 预测值: 238776.4688
实际值: 337980.3600, 预测值: 309139.5312
实际值: 315083.0500, 预测值: 311327.6875
实际值: 378091.2700, 预测值: 392384.9688

=== 第 12/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.8416
NMAE: 2.5296
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 256025.8594
实际值: 225720.8200, 预测值: 233154.2188
实际值: 337980.3600, 预测值: 315020.5000
实际值: 315083.0500, 预测值: 306093.7188
实际值: 378091.2700, 预测值: 385463.7812

=== 第 13/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.8298
NMAE: 2.1341
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 269089.0312
实际值: 225720.8200, 预测值: 231918.3750
实际值: 337980.3600, 预测值: 321146.6250
实际值: 315083.0500, 预测值: 308247.2812
实际值: 378091.2700, 预测值: 397965.3750

=== 第 14/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.8605
NMAE: 2.6586
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 261119.0312
实际值: 225720.8200, 预测值: 221258.5000
实际值: 337980.3600, 预测值: 329696.0312
实际值: 315083.0500, 预测值: 313110.8438
实际值: 378091.2700, 预测值: 391849.4688

=== 第 15/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.8030
NMAE: 2.1697
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 271193.1875
实际值: 225720.8200, 预测值: 244039.1562
实际值: 337980.3600, 预测值: 315210.8438
实际值: 315083.0500, 预测值: 299694.1250
实际值: 378091.2700, 预测值: 373007.0312

=== 第 16/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.8306
NMAE: 2.5186
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 262032.9844
实际值: 225720.8200, 预测值: 234403.7656
实际值: 337980.3600, 预测值: 318925.8438
实际值: 315083.0500, 预测值: 295888.4062
实际值: 378091.2700, 预测值: 381624.8125

=== 第 17/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.8228
NMAE: 2.2211
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 263391.7188
实际值: 225720.8200, 预测值: 231888.0000
实际值: 337980.3600, 预测值: 316934.4375
实际值: 315083.0500, 预测值: 289663.1875
实际值: 378091.2700, 预测值: 385416.2812

=== 第 18/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.8462
NMAE: 2.5270
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 264205.4062
实际值: 225720.8200, 预测值: 217097.7188
实际值: 337980.3600, 预测值: 317810.7812
实际值: 315083.0500, 预测值: 299349.4688
实际值: 378091.2700, 预测值: 377350.9688

=== 第 19/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8415
NMAE: 2.7786
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 261087.1250
实际值: 225720.8200, 预测值: 223879.5000
实际值: 337980.3600, 预测值: 323087.8438
实际值: 315083.0500, 预测值: 297887.6562
实际值: 378091.2700, 预测值: 384231.1562

=== 第 20/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.8549
NMAE: 2.7071
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 257220.7500
实际值: 225720.8200, 预测值: 233210.0938
实际值: 337980.3600, 预测值: 320118.1562
实际值: 315083.0500, 预测值: 288303.4062
实际值: 378091.2700, 预测值: 389624.3750

=== 最佳模型已保存 ===
最高 R²分数: 0.8791

最佳模型预测结果(前5行):
实际值: 284581.6200, 预测值: 278775.3438
实际值: 225720.8200, 预测值: 237755.2188
实际值: 337980.3600, 预测值: 310253.8125
实际值: 315083.0500, 预测值: 307467.4375
实际值: 378091.2700, 预测值: 386400.2188
晶粒尺寸INFO: r2均值: 0.3895, nmae均值: 2.3942
模具载荷INFO: r2均值: 0.8344, nmae均值: 2.3366
(venv) hmr@MRH:~/Multi-obj-optimism$ /home/hmr/Multi-obj-optimism/venv/bin/python /home/hmr/Multi-obj-optimism/src/SurrogateModel/DNN-model.py
2025-09-24 11:18:30.317470: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-09-24 11:18:30.397752: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-24 11:18:31.691606: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
训练晶粒尺寸标准差模型...

=== 第 1/20 次训练 ===
2025-09-24 11:18:33.181952: E external/local_xla/xla/stream_executor/cuda/cuda_platform.cc:51] failed call to cuInit: INTERNAL: CUDA error: Failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.3514
NMAE: 3.0505
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.1648
实际值: 31.7000, 预测值: 33.6311
实际值: 22.2100, 预测值: 27.1746
实际值: 26.1800, 预测值: 25.1976
实际值: 26.5300, 预测值: 20.0971

=== 第 2/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.0056
NMAE: 2.2936
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 26.6152
实际值: 31.7000, 预测值: 27.2101
实际值: 22.2100, 预测值: 26.7652
实际值: 26.1800, 预测值: 26.8683
实际值: 26.5300, 预测值: 25.9119

=== 第 3/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.6424
NMAE: 2.2458
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.9201
实际值: 31.7000, 预测值: 29.2247
实际值: 22.2100, 预测值: 21.6530
实际值: 26.1800, 预测值: 27.6134
实际值: 26.5300, 预测值: 21.9092

=== 第 4/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.6792
NMAE: 2.5268
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.5202
实际值: 31.7000, 预测值: 29.3094
实际值: 22.2100, 预测值: 23.9038
实际值: 26.1800, 预测值: 28.3439
实际值: 26.5300, 预测值: 22.7796

=== 第 5/20 次训练 ===
WARNING:tensorflow:5 out of the last 5 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7f24486a2830> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.7740
NMAE: 2.5668
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.4754
实际值: 31.7000, 预测值: 29.8999
实际值: 22.2100, 预测值: 22.9704
实际值: 26.1800, 预测值: 25.6788
实际值: 26.5300, 预测值: 23.4966

=== 第 6/20 次训练 ===
WARNING:tensorflow:6 out of the last 6 calls to <function TensorFlowTrainer.make_predict_function.<locals>.one_step_on_data_distributed at 0x7f24607ba710> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.7664
NMAE: 2.8489
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.9965
实际值: 31.7000, 预测值: 31.1230
实际值: 22.2100, 预测值: 21.6575
实际值: 26.1800, 预测值: 26.3397
实际值: 26.5300, 预测值: 23.2354

=== 第 7/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.7722
NMAE: 2.6099
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.9279
实际值: 31.7000, 预测值: 28.6242
实际值: 22.2100, 预测值: 22.4787
实际值: 26.1800, 预测值: 26.7720
实际值: 26.5300, 预测值: 23.3320

=== 第 8/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.7631
NMAE: 2.6365
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 31.6913
实际值: 31.7000, 预测值: 30.3537
实际值: 22.2100, 预测值: 24.3704
实际值: 26.1800, 预测值: 29.7185
实际值: 26.5300, 预测值: 22.3602

=== 第 9/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 56ms/step
R²分数: 0.8092
NMAE: 2.9495
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.8168
实际值: 31.7000, 预测值: 30.3278
实际值: 22.2100, 预测值: 22.6842
实际值: 26.1800, 预测值: 27.0896
实际值: 26.5300, 预测值: 22.2173

=== 第 10/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 64ms/step
R²分数: 0.6514
NMAE: 2.0007
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.4270
实际值: 31.7000, 预测值: 26.0910
实际值: 22.2100, 预测值: 23.1111
实际值: 26.1800, 预测值: 28.0466
实际值: 26.5300, 预测值: 23.7301

=== 第 11/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.8126
NMAE: 3.1194
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.5477
实际值: 31.7000, 预测值: 31.7320
实际值: 22.2100, 预测值: 25.6861
实际值: 26.1800, 预测值: 28.0541
实际值: 26.5300, 预测值: 22.9104

=== 第 12/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step
R²分数: 0.1358
NMAE: 2.2808
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.3322
实际值: 31.7000, 预测值: 27.6502
实际值: 22.2100, 预测值: 26.8608
实际值: 26.1800, 预测值: 27.3455
实际值: 26.5300, 预测值: 25.9238

=== 第 13/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.6849
NMAE: 2.0825
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.1444
实际值: 31.7000, 预测值: 28.7148
实际值: 22.2100, 预测值: 24.3957
实际值: 26.1800, 预测值: 27.4984
实际值: 26.5300, 预测值: 23.3263

=== 第 14/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.7142
NMAE: 2.3383
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.5003
实际值: 31.7000, 预测值: 30.3166
实际值: 22.2100, 预测值: 23.8762
实际值: 26.1800, 预测值: 26.6945
实际值: 26.5300, 预测值: 23.3713

=== 第 15/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 54ms/step
R²分数: 0.6375
NMAE: 1.6827
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 30.0331
实际值: 31.7000, 预测值: 32.5121
实际值: 22.2100, 预测值: 26.9690
实际值: 26.1800, 预测值: 27.8787
实际值: 26.5300, 预测值: 25.0686

=== 第 16/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 60ms/step
R²分数: 0.8015
NMAE: 3.4068
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 31.6539
实际值: 31.7000, 预测值: 30.7595
实际值: 22.2100, 预测值: 22.0604
实际值: 26.1800, 预测值: 27.6752
实际值: 26.5300, 预测值: 22.3466

=== 第 17/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step
R²分数: 0.1439
NMAE: 2.2181
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 27.6681
实际值: 31.7000, 预测值: 26.6727
实际值: 22.2100, 预测值: 26.5145
实际值: 26.1800, 预测值: 26.7706
实际值: 26.5300, 预测值: 27.9595

=== 第 18/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.6687
NMAE: 2.5714
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 29.3060
实际值: 31.7000, 预测值: 28.8655
实际值: 22.2100, 预测值: 25.0274
实际值: 26.1800, 预测值: 25.7660
实际值: 26.5300, 预测值: 23.9964

=== 第 19/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 55ms/step
R²分数: 0.6960
NMAE: 2.6096
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 28.9213
实际值: 31.7000, 预测值: 31.1400
实际值: 22.2100, 预测值: 23.1815
实际值: 26.1800, 预测值: 26.3952
实际值: 26.5300, 预测值: 22.4689

=== 第 20/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 52ms/step
R²分数: 0.6915
NMAE: 2.3736
实际值 vs. 预测值(前5行):
实际值: 30.7500, 预测值: 29.6095
实际值: 31.7000, 预测值: 31.0207
实际值: 22.2100, 预测值: 24.2500
实际值: 26.1800, 预测值: 26.1834
实际值: 26.5300, 预测值: 24.3899

=== 最佳模型已保存 ===
最高 R²分数: 0.8126

最佳模型预测结果(前5行):
实际值: 30.7500, 预测值: 30.5477
实际值: 31.7000, 预测值: 31.7320
实际值: 22.2100, 预测值: 25.6861
实际值: 26.1800, 预测值: 28.0541
实际值: 26.5300, 预测值: 22.9104

训练模具载荷模型...

=== 第 1/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8343
NMAE: 2.6106
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 265397.3438
实际值: 225720.8200, 预测值: 244013.7500
实际值: 337980.3600, 预测值: 322871.5938
实际值: 315083.0500, 预测值: 325047.8750
实际值: 378091.2700, 预测值: 376737.4688

=== 第 2/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.8390
NMAE: 2.3031
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 261017.8281
实际值: 225720.8200, 预测值: 237737.4688
实际值: 337980.3600, 预测值: 322746.9375
实际值: 315083.0500, 预测值: 295926.0625
实际值: 378091.2700, 预测值: 377440.1562

=== 第 3/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8327
NMAE: 2.8487
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 270122.5625
实际值: 225720.8200, 预测值: 242456.3594
实际值: 337980.3600, 预测值: 308611.6875
实际值: 315083.0500, 预测值: 309712.9375
实际值: 378091.2700, 预测值: 376600.2500

=== 第 4/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step
R²分数: 0.8580
NMAE: 2.4811
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 258189.9219
实际值: 225720.8200, 预测值: 229436.8906
实际值: 337980.3600, 预测值: 313893.1875
实际值: 315083.0500, 预测值: 308500.7812
实际值: 378091.2700, 预测值: 388650.9688

=== 第 5/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.8447
NMAE: 1.9711
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 264778.5625
实际值: 225720.8200, 预测值: 224371.9375
实际值: 337980.3600, 预测值: 324559.6250
实际值: 315083.0500, 预测值: 291570.9375
实际值: 378091.2700, 预测值: 380270.8438

=== 第 6/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.8523
NMAE: 2.8596
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 267372.3125
实际值: 225720.8200, 预测值: 224485.9062
实际值: 337980.3600, 预测值: 329094.7188
实际值: 315083.0500, 预测值: 294466.8438
实际值: 378091.2700, 预测值: 392136.4062

=== 第 7/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.8627
NMAE: 2.8919
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 270279.4062
实际值: 225720.8200, 预测值: 246710.9062
实际值: 337980.3600, 预测值: 329279.7188
实际值: 315083.0500, 预测值: 303802.0938
实际值: 378091.2700, 预测值: 406016.2188

=== 第 8/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.8161
NMAE: 2.5285
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 268546.7500
实际值: 225720.8200, 预测值: 234520.9688
实际值: 337980.3600, 预测值: 314361.9375
实际值: 315083.0500, 预测值: 294598.7812
实际值: 378091.2700, 预测值: 378202.9062

=== 第 9/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 59ms/step
R²分数: 0.8627
NMAE: 2.5925
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 261926.9688
实际值: 225720.8200, 预测值: 242425.9219
实际值: 337980.3600, 预测值: 324749.4062
实际值: 315083.0500, 预测值: 310613.4375
实际值: 378091.2700, 预测值: 382958.4375

=== 第 10/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 66ms/step
R²分数: 0.7992
NMAE: 1.9003
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 263536.4688
实际值: 225720.8200, 预测值: 248809.4375
实际值: 337980.3600, 预测值: 327432.9375
实际值: 315083.0500, 预测值: 293500.3125
实际值: 378091.2700, 预测值: 371490.0312

=== 第 11/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 70ms/step
R²分数: 0.8383
NMAE: 2.1866
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 278446.8750
实际值: 225720.8200, 预测值: 244080.7031
实际值: 337980.3600, 预测值: 322733.6875
实际值: 315083.0500, 预测值: 288895.1875
实际值: 378091.2700, 预测值: 379008.5312

=== 第 12/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 91ms/step
R²分数: 0.8138
NMAE: 2.7720
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 264417.8750
实际值: 225720.8200, 预测值: 231454.6875
实际值: 337980.3600, 预测值: 317196.6875
实际值: 315083.0500, 预测值: 302566.9375
实际值: 378091.2700, 预测值: 387697.8438

=== 第 13/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 57ms/step
R²分数: 0.8269
NMAE: 2.3464
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 253848.6719
实际值: 225720.8200, 预测值: 231193.3125
实际值: 337980.3600, 预测值: 318855.1250
实际值: 315083.0500, 预测值: 288747.6875
实际值: 378091.2700, 预测值: 385973.5625

=== 第 14/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step
R²分数: 0.8615
NMAE: 2.3475
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 262604.0000
实际值: 225720.8200, 预测值: 243693.1250
实际值: 337980.3600, 预测值: 333179.0938
实际值: 315083.0500, 预测值: 292973.1875
实际值: 378091.2700, 预测值: 398966.2188

=== 第 15/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8549
NMAE: 2.3519
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 260779.8125
实际值: 225720.8200, 预测值: 245122.5312
实际值: 337980.3600, 预测值: 316055.7500
实际值: 315083.0500, 预测值: 308801.2188
实际值: 378091.2700, 预测值: 395172.5000

=== 第 16/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8644
NMAE: 2.6257
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 251449.3750
实际值: 225720.8200, 预测值: 222513.5469
实际值: 337980.3600, 预测值: 335640.0312
实际值: 315083.0500, 预测值: 307090.1250
实际值: 378091.2700, 预测值: 394157.7188

=== 第 17/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step
R²分数: 0.8256
NMAE: 2.2451
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 265190.4062
实际值: 225720.8200, 预测值: 224054.6719
实际值: 337980.3600, 预测值: 314328.0625
实际值: 315083.0500, 预测值: 307584.9062
实际值: 378091.2700, 预测值: 383989.7188

=== 第 18/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 63ms/step
R²分数: 0.8229
NMAE: 2.7009
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 269482.9062
实际值: 225720.8200, 预测值: 258621.5156
实际值: 337980.3600, 预测值: 312271.5000
实际值: 315083.0500, 预测值: 312196.6875
实际值: 378091.2700, 预测值: 384170.7500

=== 第 19/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 62ms/step
R²分数: 0.8248
NMAE: 2.0222
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 265558.5938
实际值: 225720.8200, 预测值: 238300.6406
实际值: 337980.3600, 预测值: 310399.9688
实际值: 315083.0500, 预测值: 310987.7812
实际值: 378091.2700, 预测值: 380821.1250

=== 第 20/20 次训练 ===
1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 61ms/step
R²分数: 0.8446
NMAE: 2.4905
实际值 vs. 预测值(前5行):
实际值: 284581.6200, 预测值: 273460.5938
实际值: 225720.8200, 预测值: 237760.0938
实际值: 337980.3600, 预测值: 314713.4062
实际值: 315083.0500, 预测值: 309956.3125
实际值: 378091.2700, 预测值: 379032.5312

=== 最佳模型已保存 ===
最高 R²分数: 0.8644

最佳模型预测结果(前5行):
实际值: 284581.6200, 预测值: 251449.3750
实际值: 225720.8200, 预测值: 222513.5469
实际值: 337980.3600, 预测值: 335640.0312
实际值: 315083.0500, 预测值: 307090.1250
实际值: 378091.2700, 预测值: 394157.7188
晶粒尺寸INFO: r2均值: 0.6101, nmae均值: 2.5206
模具载荷INFO: r2均值: 0.8390, nmae均值: 2.4538